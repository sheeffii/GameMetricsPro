apiVersion: v1
kind: Service
metadata:
  name: timescaledb-public
  namespace: gamemetrics
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing
    service.beta.kubernetes.io/aws-load-balancer-type: nlb
    service.beta.kubernetes.io/aws-load-balancer-healthcheck-protocol: TCP
    service.beta.kubernetes.io/aws-load-balancer-healthcheck-port: "5432"
    # TODO: tighten exposure with source ranges or SGs if possible.
spec:
  type: LoadBalancer
  selector:
    app: timescaledb
  ports:
    - name: postgres
      port: 5432
      targetPort: 5432
      protocol: TCP
